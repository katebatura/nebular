"use strict";(self.webpackChunknebular=self.webpackChunknebular||[]).push([[949],{90949:function(t,e,n){n.r(e),n.d(e,{AzurePlaygroundModule:function(){return U}});var r=n(38583),s=n(3679),o=n(91841),i=n(32937),u=n(44265),c=n(68729),a=n(25917),l=n(43190),p=n(88002),h=n(5304),d=n(93264),g=n(9814),f=n(97501),b=n(42305),k=n(37716);let y=(()=>{class t extends d.Xq{getValue(){return this.token.id_token}}return t.NAME="nb:auth:azure:token",t})(),m=(()=>{class t extends g.F{constructor(){super(...arguments),this.redirectResultHandlers={[f.aW.CODE]:()=>(0,a.of)(this.route.snapshot.queryParams).pipe((0,l.w)(t=>t.code?this.requestToken(t.code):(0,a.of)(new b.g(!1,t,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[])))),id_token:()=>{const t=this.getOption("authorize.requireValidToken");return(0,a.of)(this.route.snapshot.fragment).pipe((0,p.U)(t=>this.parseHashAsQueryParams(t)),(0,p.U)(e=>e.error?new b.g(!1,e,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[]):new b.g(!0,e,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(e,t))),(0,h.K)(t=>{const e=[];return e.push(t instanceof d.ww?t.message:"Something went wrong."),(0,a.of)(new b.g(!1,t,this.getOption("redirect.failure"),e))}))}},this.redirectResults={[f.aW.CODE]:()=>(0,a.of)(null),id_token:()=>(0,a.of)(this.route.snapshot.fragment).pipe((0,p.U)(t=>this.parseHashAsQueryParams(t)),(0,p.U)(t=>!(!t||!t.id_token&&!t.error)))}}static setup(e){return[t,e]}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=k.n5z(t)))(n||t)}}(),t.\u0275prov=k.Yz7({token:t,factory:t.\u0275fac}),t})();var A=n(10494),w=n(46782),Z=n(79765),z=n(15798),v=n(40646);let T=(()=>{class t{constructor(t,e){this.authService=t,this.router=e,this.destroy$=new Z.xQ,this.authService.authenticate("azure").pipe((0,w.R)(this.destroy$)).subscribe(t=>{t.isSuccess()&&t.getRedirect()&&this.router.navigateByUrl(t.getRedirect())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(k.Y36(z._),k.Y36(A.F0))},t.\u0275cmp=k.Xpm({type:t,selectors:[["nb-playground-azure-callback"]],decls:3,vars:0,template:function(t,e){1&t&&(k.TgZ(0,"nb-layout"),k.TgZ(1,"nb-layout-column"),k._uU(2,"Authenticating..."),k.qZA(),k.qZA())},directives:[v.Aq,v.dP],encapsulation:2}),t})();var q=n(74743);function x(t,e){if(1&t){const t=k.EpF();k.TgZ(0,"button",2),k.NdJ("click",function(){return k.CHM(t),k.oxw().login()}),k._uU(1,"Sign In with Azure"),k.qZA()}}function O(t,e){if(1&t){const t=k.EpF();k.TgZ(0,"button",3),k.NdJ("click",function(){return k.CHM(t),k.oxw().logout()}),k._uU(1,"Sign Out"),k.qZA()}}const S=[{path:"",component:(()=>{class t{constructor(t){this.authService=t,this.destroy$=new Z.xQ,this.authService.onTokenChange().pipe((0,w.R)(this.destroy$)).subscribe(t=>{this.token=null,t&&t.isValid()&&(this.token=t)})}login(){this.authService.authenticate("azure").pipe((0,w.R)(this.destroy$)).subscribe(t=>{})}logout(){this.authService.logout("azure").pipe((0,w.R)(this.destroy$)).subscribe(t=>{})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(k.Y36(z._))},t.\u0275cmp=k.Xpm({type:t,selectors:[["nb-playground-azure"]],decls:11,vars:6,consts:[["nbButton","","status","success",3,"click",4,"ngIf"],["nbButton","","status","warning",3,"click",4,"ngIf"],["nbButton","","status","success",3,"click"],["nbButton","","status","warning",3,"click"]],template:function(t,e){1&t&&(k.TgZ(0,"nb-layout"),k.TgZ(1,"nb-layout-column"),k.TgZ(2,"nb-card"),k.TgZ(3,"nb-card-body"),k.TgZ(4,"p"),k._uU(5),k.qZA(),k.TgZ(6,"p"),k._uU(7),k.ALo(8,"json"),k.qZA(),k.YNc(9,x,2,0,"button",0),k.YNc(10,O,2,0,"button",1),k.qZA(),k.qZA(),k.qZA(),k.qZA()),2&t&&(k.xp6(5),k.hij("Current User Authenticated: ",!!e.token,""),k.xp6(2),k.hij("Current User Token: ",k.lcZ(8,4,e.token),""),k.xp6(2),k.Q6J("ngIf",!e.token),k.xp6(1),k.Q6J("ngIf",e.token))},directives:[v.Aq,v.dP,q.As,q.yK,r.O5],pipes:[r.Ts],encapsulation:2}),t})()},{path:"callback",component:T}];let _=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({imports:[[A.Bz.forChild(S)],A.Bz]}),t})(),U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=k.oAB({type:t}),t.\u0275inj=k.cJS({providers:[m],imports:[[r.ez,s.u5,o.JF,c.S.forRoot({strategies:[m.setup({name:"azure",clientId:"bde728e2-2809-4ff1-bc9c-7fcb23800ebe",clientSecret:"",authorize:{endpoint:"https://login.microsoftonline.com/01513fd2-16a0-453b-9fa0-c9089bfa023e/oauth2/authorize",responseType:"id_token",scope:"openid",redirectUri:"https://akveo.github.io/nebular/example/azure/callback",params:{p:"b2c_1_nebular"}},token:{class:y},redirect:{success:"/example/azure"}})]}),i.z,u.B,_]]}),t})()}}]);