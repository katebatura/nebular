"use strict";(self.webpackChunknebular=self.webpackChunknebular||[]).push([[8729],{68729:function(e,t,r){r.d(t,{S:function(){return v}});var s=r(37716),n=r(38583),o=r(10494),i=r(3679),a=r(44265),u=r(32937),c=r(52313),h=r(48722),p=r(71147),l=r(60534),d=r(42687),g=r(15798),f=r(93264),w=r(84399),y=r(19822),k=r(19339),O=r(16721),m=r(9814),T=r(67846),b=r(69207),E=r(47852);function A(e,t){const r=[];return e.strategies.forEach(([e,s])=>{const n=t.get(e);n.setOptions(s),r.push(n)}),r}function R(e){const t=[];return e.forEach(e=>{t.push(e.getOption("token.class"))}),t}function S(e){return(0,E.ZB)(b.GI,e)}function P(e){return!0}let v=(()=>{class e{static forRoot(t){return{ngModule:e,providers:[{provide:b.sR,useValue:t},{provide:b.h,useFactory:S,deps:[b.sR]},{provide:b.ao,useFactory:A,deps:[b.h,s.zs3]},{provide:b.oB,useFactory:R,deps:[b.ao]},{provide:k.Z,useValue:f.xC},{provide:b.g5,useValue:"Authorization"},{provide:b.nN,useValue:P},{provide:w.i,useClass:w.e},k.r,g._,y.L,O.r,T.O,m.F]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.oAB({type:e}),e.\u0275inj=s.cJS({imports:[[n.ez,a.B,u.z,c.M,h.P,p.n,l.T,o.Bz,i.u5,d.K]]}),e})()},69207:function(e,t,r){r.d(t,{GI:function(){return o},h:function(){return i},sR:function(){return a},ao:function(){return u},oB:function(){return c},g5:function(){return h},nN:function(){return p}});var s=r(37716);const n=[],o={strategies:[],forms:{login:{redirectDelay:500,strategy:"email",rememberMe:!0,showMessages:{success:!0,error:!0},socialLinks:n},register:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},terms:!0,socialLinks:n},requestPassword:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},socialLinks:n},resetPassword:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},socialLinks:n},logout:{redirectDelay:500,strategy:"email"},validation:{password:{required:!0,minLength:4,maxLength:50},email:{required:!0},fullName:{required:!1,minLength:4,maxLength:50}}}},i=new s.OlP("Nebular Auth Options"),a=new s.OlP("Nebular User Auth Options"),u=new s.OlP("Nebular Auth Strategies"),c=new s.OlP("Nebular Auth Tokens"),h=new s.OlP("Nebular Simple Interceptor Header"),p=new s.OlP("Nebular Interceptor Filter")},47852:function(e,t,r){r.d(t,{ZB:function(){return s},hB:function(){return a},XE:function(){return u}});const s=function(...e){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];const t=arguments[0],r=Array.prototype.slice.call(arguments,1);let a,u;return r.forEach(function(e){"object"!=typeof e||Array.isArray(e)||Object.keys(e).forEach(function(r){if(u=t[r],a=e[r],a!==t)return"object"!=typeof a||null===a?void(t[r]=a):Array.isArray(a)?void(t[r]=i(a)):n(a)?void(t[r]=o(a)):"object"!=typeof u||null===u||Array.isArray(u)?void(t[r]=s({},a)):void(t[r]=s(u,a))})}),t};function n(e){return e instanceof Date||e instanceof RegExp}function o(e){if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("cloneSpecificValue: Unexpected situation")}function i(e){const t=[];return e.forEach(function(e,r){t[r]="object"==typeof e&&null!==e?Array.isArray(e)?i(e):n(e)?o(e):s({},e):e}),t}function a(e={},t,r){const n=t.split(".");let o=s({},e||{});return n.forEach(e=>{o=o&&void 0!==o[e]?o[e]:void 0}),void 0===o?r:o}function u(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return function(e){return decodeURIComponent(Array.prototype.map.call(function(e){let t="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let r,s,n=0,o=0;s=e.charAt(o++);~s&&(r=n%4?64*r+s:s,n++%4)?t+=String.fromCharCode(255&r>>(-2*n&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return t}(e),e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}(t)}},42305:function(e,t,r){r.d(t,{g:function(){return s}});class s{constructor(e,t,r,s,n,o=null){this.success=e,this.response=t,this.redirect=r,this.errors=[],this.messages=[],this.errors=this.errors.concat([s]),s instanceof Array&&(this.errors=s),this.messages=this.messages.concat([n]),n instanceof Array&&(this.messages=n),this.token=o}getResponse(){return this.response}getToken(){return this.token}getRedirect(){return this.redirect}getErrors(){return this.errors.filter(e=>!!e)}getMessages(){return this.messages.filter(e=>!!e)}isSuccess(){return this.success}isFailure(){return!this.success}}},15798:function(e,t,r){r.d(t,{_:function(){return c}});var s=r(25917),n=r(88002),o=r(43190),i=r(69207),a=r(37716),u=r(19822);let c=(()=>{class e{constructor(e,t){this.tokenService=e,this.strategies=t}getToken(){return this.tokenService.get()}isAuthenticated(){return this.getToken().pipe((0,n.U)(e=>e.isValid()))}isAuthenticatedOrRefresh(){return this.getToken().pipe((0,o.w)(e=>e.getValue()&&!e.isValid()?this.refreshToken(e.getOwnerStrategyName(),e).pipe((0,o.w)(e=>e.isSuccess()?this.isAuthenticated():(0,s.of)(!1))):(0,s.of)(e.isValid())))}onTokenChange(){return this.tokenService.tokenChange()}onAuthenticationChange(){return this.onTokenChange().pipe((0,n.U)(e=>e.isValid()))}authenticate(e,t){return this.getStrategy(e).authenticate(t).pipe((0,o.w)(e=>this.processResultToken(e)))}register(e,t){return this.getStrategy(e).register(t).pipe((0,o.w)(e=>this.processResultToken(e)))}logout(e){return this.getStrategy(e).logout().pipe((0,o.w)(e=>(e.isSuccess()&&this.tokenService.clear().pipe((0,n.U)(()=>e)),(0,s.of)(e))))}requestPassword(e,t){return this.getStrategy(e).requestPassword(t)}resetPassword(e,t){return this.getStrategy(e).resetPassword(t)}refreshToken(e,t){return this.getStrategy(e).refreshToken(t).pipe((0,o.w)(e=>this.processResultToken(e)))}getStrategy(e){const t=this.strategies.find(t=>t.getName()===e);if(!t)throw new TypeError(`There is no Auth Strategy registered under '${e}' name`);return t}processResultToken(e){return e.isSuccess()&&e.getToken()?this.tokenService.set(e.getToken()).pipe((0,n.U)(t=>e)):(0,s.of)(e)}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(u.L),a.LFG(i.ao))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac}),e})()},19339:function(e,t,r){r.d(t,{Z:function(){return i},r:function(){return a}});var s=r(37716),n=r(93264),o=r(69207);const i=new s.OlP("Nebular Auth Options");let a=(()=>{class e{constructor(e,t){this.fallbackClass=e,this.tokenClasses=t}wrap(e){return JSON.stringify({name:e.getName(),ownerStrategyName:e.getOwnerStrategyName(),createdAt:e.getCreatedAt().getTime(),value:e.toString()})}unwrap(e){let t=this.fallbackClass,r="",s="",o=null;const i=this.parseTokenPack(e);return i&&(t=this.getClassByName(i.name)||this.fallbackClass,r=i.value,s=i.ownerStrategyName,o=new Date(Number(i.createdAt))),(0,n.P_)(t,r,s,o)}getClassByName(e){return this.tokenClasses.find(t=>t.NAME===e)}parseTokenPack(e){try{return JSON.parse(e)}catch(t){}return null}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(i),s.LFG(o.oB))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac}),e})()},84399:function(e,t,r){r.d(t,{i:function(){return o},e:function(){return i}});var s=r(37716),n=r(19339);class o{}let i=(()=>{class e extends o{constructor(e){super(),this.parceler=e,this.key="auth_app_token"}get(){const e=localStorage.getItem(this.key);return this.parceler.unwrap(e)}set(e){const t=this.parceler.wrap(e);localStorage.setItem(this.key,t)}clear(){localStorage.removeItem(this.key)}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(n.r))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac}),e})()},19822:function(e,t,r){r.d(t,{L:function(){return c}});var s=r(26215),n=r(25917),o=r(45435),i=r(78345),a=r(37716),u=r(84399);let c=(()=>{class e{constructor(e){this.tokenStorage=e,this.token$=new s.X(null),this.publishStoredToken()}tokenChange(){return this.token$.pipe((0,o.h)(e=>!!e),(0,i.B)())}set(e){return this.tokenStorage.set(e),this.publishStoredToken(),(0,n.of)(null)}get(){const e=this.tokenStorage.get();return(0,n.of)(e)}clear(){return this.tokenStorage.clear(),this.publishStoredToken(),(0,n.of)(null)}publishStoredToken(){this.token$.next(this.tokenStorage.get())}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(u.i))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac}),e})()},93264:function(e,t,r){r.d(t,{ww:function(){return o},P_:function(){return u},xC:function(){return h},OS:function(){return p},FN:function(){return l},Xq:function(){return d}});var s=r(47852);class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class i extends o{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class a extends o{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}function u(e,t,r,s){return new e(t,r,s)}function c(e){if(0===e.length)throw new i("Cannot extract from an empty payload.");const t=e.split(".");if(3!==t.length)throw new a(`The payload ${e} is not valid JWT payload and must consist of three parts.`);let r;try{r=(0,s.XE)(t[1])}catch(n){throw new a(`The payload ${e} is not valid JWT payload and cannot be parsed.`)}if(!r)throw new a(`The payload ${e} is not valid JWT payload and cannot be decoded.`);return JSON.parse(r)}let h=(()=>{class e extends class{constructor(){this.payload=null}getName(){return this.constructor.NAME}getPayload(){return this.payload}}{constructor(e,t,r){super(),this.token=e,this.ownerStrategyName=t,this.createdAt=r;try{this.parsePayload()}catch(s){if(!(s instanceof n))throw s}this.createdAt=this.prepareCreatedAt(r)}parsePayload(){this.payload=null}prepareCreatedAt(e){return e||new Date}getCreatedAt(){return this.createdAt}getValue(){return this.token}getOwnerStrategyName(){return this.ownerStrategyName}isValid(){return!!this.getValue()}toString(){return this.token?this.token:""}}return e.NAME="nb:auth:simple:token",e})(),p=(()=>{class e extends h{prepareCreatedAt(e){const t=this.getPayload();return t&&t.iat?new Date(1e3*Number(t.iat)):super.prepareCreatedAt(e)}parsePayload(){if(!this.token)throw new n("Token not found. ");this.payload=c(this.token)}getTokenExpDate(){const e=this.getPayload();if(e&&!e.hasOwnProperty("exp"))return null;const t=new Date(0);return t.setUTCSeconds(e.exp),t}isValid(){return super.isValid()&&(!this.getTokenExpDate()||new Date<this.getTokenExpDate())}}return e.NAME="nb:auth:jwt:token",e})(),l=(()=>{class e extends h{constructor(e={},t,r){super((e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){}return e})(e),t,r)}getValue(){return this.token.access_token}getRefreshToken(){return this.token.refresh_token}setRefreshToken(e){this.token.refresh_token=e}parsePayload(){if(!this.token)throw new n("Token not found.");if(!Object.keys(this.token).length)throw new i("Cannot extract payload from an empty token.");this.payload=this.token}getType(){return this.token.token_type}isValid(){return super.isValid()&&(!this.getTokenExpDate()||new Date<this.getTokenExpDate())}getTokenExpDate(){return this.token.hasOwnProperty("expires_in")?new Date(this.createdAt.getTime()+1e3*Number(this.token.expires_in)):null}toString(){return JSON.stringify(this.token)}}return e.NAME="nb:auth:oauth2:token",e})(),d=(()=>{class e extends l{parsePayload(){super.parsePayload(),this.parseAccessTokenPayload()}parseAccessTokenPayload(){const e=this.getValue();if(!e)throw new n("access_token key not found.");this.accessTokenPayload=c(e)}getAccessTokenPayload(){return this.accessTokenPayload}prepareCreatedAt(e){const t=this.accessTokenPayload;return t&&t.iat?new Date(1e3*Number(t.iat)):super.prepareCreatedAt(e)}isValid(){return this.accessTokenPayload&&super.isValid()}getTokenExpDate(){if(this.accessTokenPayload&&this.accessTokenPayload.hasOwnProperty("exp")){const e=new Date(0);return e.setUTCSeconds(this.accessTokenPayload.exp),e}return super.getTokenExpDate()}}return e.NAME="nb:auth:oauth2:jwt:token",e})()},41854:function(e,t,r){r.d(t,{Y:function(){return s}});class s{}},95607:function(e,t,r){r.d(t,{D:function(){return i}});var s=r(91841),n=r(47852),o=r(93264);class i{setOptions(e){this.options=(0,n.ZB)({},this.defaultOptions,e)}getOption(e){return(0,n.hB)(this.options,e,null)}createToken(e,t){const r=(0,o.P_)(this.getOption("token.class"),e,this.getName());if(t&&!r.isValid())throw new o.ww("Token is empty or invalid.");return r}getName(){return this.getOption("name")}createFailResponse(e){return new s.Zn({body:{},status:401})}createSuccessResponse(e){return new s.Zn({body:{},status:200})}getActionEndpoint(e){const t=this.getOption(`${e}.endpoint`),r=this.getOption("baseEndpoint");return t?r+t:""}}},16721:function(e,t,r){r.d(t,{r:function(){return p}});var s=r(25917),n=r(71289),o=r(95607),i=r(42305),a=r(41854),u=r(93264);const c=new class extends a.Y{constructor(){super(...arguments),this.token={class:u.xC},this.delay=1e3,this.alwaysFail=!1}};var h=r(37716);let p=(()=>{class e extends o.D{constructor(){super(...arguments),this.defaultOptions=c}static setup(t){return[e,t]}authenticate(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}register(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}requestPassword(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}resetPassword(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}logout(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}refreshToken(e){return(0,s.of)(this.createDummyResult(e)).pipe((0,n.g)(this.getOption("delay")))}createDummyResult(e){if(this.getOption("alwaysFail"))return new i.g(!1,this.createFailResponse(e),null,["Something went wrong."]);try{const t=this.createToken("test token",!0);return new i.g(!0,this.createSuccessResponse(e),"/",[],["Successfully logged in."],t)}catch(t){return new i.g(!1,this.createFailResponse(e),null,[t.message])}}}return e.\u0275fac=function(){let t;return function(r){return(t||(t=h.n5z(e)))(r||e)}}(),e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac}),e})()},97501:function(e,t,r){r.d(t,{aW:function(){return o},sY:function(){return i},rW:function(){return a},N2:function(){return u}});var s=r(93264),n=r(41854),o=(()=>{return(e=o||(o={})).CODE="code",e.TOKEN="token",o;var e})(),i=(()=>{return(e=i||(i={})).AUTHORIZATION_CODE="authorization_code",e.PASSWORD="password",e.REFRESH_TOKEN="refresh_token",i;var e})(),a=(()=>{return(e=a||(a={})).NONE="none",e.BASIC="basic",e.REQUEST_BODY="request-body",a;var e})();const u=new class extends n.Y{constructor(){super(...arguments),this.baseEndpoint="",this.clientId="",this.clientSecret="",this.clientAuthMethod=a.NONE,this.redirect={success:"/",failure:null},this.defaultErrors=["Something went wrong, please try again."],this.defaultMessages=["You have been successfully authenticated."],this.authorize={endpoint:"authorize",responseType:o.CODE,requireValidToken:!0},this.token={endpoint:"token",grantType:i.AUTHORIZATION_CODE,requireValidToken:!0,class:s.FN},this.refresh={endpoint:"token",grantType:i.REFRESH_TOKEN,requireValidToken:!0}}}},9814:function(e,t,r){r.d(t,{F:function(){return f}});var s=r(91841),n=r(25917),o=r(43190),i=r(88002),a=r(5304),u=r(56722),c=r(95607),h=r(93264),p=r(42305),l=r(97501),d=r(37716),g=r(10494);let f=(()=>{class e extends c.D{constructor(e,t,r){super(),this.http=e,this.route=t,this.window=r,this.redirectResultHandlers={[l.aW.CODE]:()=>(0,n.of)(this.route.snapshot.queryParams).pipe((0,o.w)(e=>e.code?this.requestToken(e.code):(0,n.of)(new p.g(!1,e,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[])))),[l.aW.TOKEN]:()=>{const e=this.getOption("authorize.requireValidToken");return(0,n.of)(this.route.snapshot.fragment).pipe((0,i.U)(e=>this.parseHashAsQueryParams(e)),(0,i.U)(t=>t.error?new p.g(!1,t,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[]):new p.g(!0,t,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(t,e))),(0,a.K)(e=>{const t=[];return t.push(e instanceof h.ww?e.message:"Something went wrong."),(0,n.of)(new p.g(!1,e,this.getOption("redirect.failure"),t))}))}},this.redirectResults={[l.aW.CODE]:()=>(0,n.of)(this.route.snapshot.queryParams).pipe((0,i.U)(e=>!(!e||!e.code&&!e.error))),[l.aW.TOKEN]:()=>(0,n.of)(this.route.snapshot.fragment).pipe((0,i.U)(e=>this.parseHashAsQueryParams(e)),(0,i.U)(e=>!(!e||!e.access_token&&!e.error)))},this.defaultOptions=l.N2}static setup(t){return[e,t]}get responseType(){return this.getOption("authorize.responseType")}get clientAuthMethod(){return this.getOption("clientAuthMethod")}authenticate(e){return this.getOption("token.grantType")===l.sY.PASSWORD?this.passwordToken(e.email,e.password):this.isRedirectResult().pipe((0,o.w)(e=>e?this.getAuthorizationResult():(this.authorizeRedirect(),(0,n.of)(new p.g(!0)))))}getAuthorizationResult(){const e=this.redirectResultHandlers[this.responseType];if(e)return e.call(this);throw new Error(`'${this.responseType}' responseType is not supported,\n                      only 'token' and 'code' are supported now`)}refreshToken(e){const t="refresh",r=this.getActionEndpoint(t),n=this.getOption(`${t}.requireValidToken`);let o=this.buildAuthHeader()||new s.WM;return o=o.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(r,this.buildRefreshRequestData(e),{headers:o}).pipe((0,i.U)(t=>new p.g(!0,t,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createRefreshedToken(t,e,n))),(0,a.K)(e=>this.handleResponseError(e)))}passwordToken(e,t){const r="token",n=this.getActionEndpoint(r),o=this.getOption(`${r}.requireValidToken`);let u=this.buildAuthHeader()||new s.WM;return u=u.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(n,this.buildPasswordRequestData(e,t),{headers:u}).pipe((0,i.U)(e=>new p.g(!0,e,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(e,o))),(0,a.K)(e=>this.handleResponseError(e)))}authorizeRedirect(){this.window.location.href=this.buildRedirectUrl()}isRedirectResult(){return this.redirectResults[this.responseType].call(this)}requestToken(e){const t="token",r=this.getActionEndpoint(t),n=this.getOption(`${t}.requireValidToken`);let o=this.buildAuthHeader()||new s.WM;return o=o.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(r,this.buildCodeRequestData(e),{headers:o}).pipe((0,i.U)(e=>new p.g(!0,e,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(e,n))),(0,a.K)(e=>this.handleResponseError(e)))}buildCodeRequestData(e){const t={grant_type:this.getOption("token.grantType"),code:e,redirect_uri:this.getOption("token.redirectUri"),client_id:this.getOption("clientId")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(t)))}buildRefreshRequestData(e){const t={grant_type:this.getOption("refresh.grantType"),refresh_token:e.getRefreshToken(),scope:this.getOption("refresh.scope"),client_id:this.getOption("clientId")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(t)))}buildPasswordRequestData(e,t){const r={grant_type:this.getOption("token.grantType"),username:e,password:t,scope:this.getOption("token.scope")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(r)))}buildAuthHeader(){if(this.clientAuthMethod===l.rW.BASIC){if(this.getOption("clientId")&&this.getOption("clientSecret"))return new s.WM({Authorization:"Basic "+btoa(this.getOption("clientId")+":"+this.getOption("clientSecret"))});throw Error("For basic client authentication method, please provide both clientId & clientSecret.")}}cleanParams(e){return Object.entries(e).forEach(([t,r])=>!r&&delete e[t]),e}addCredentialsToParams(e){if(this.clientAuthMethod===l.rW.REQUEST_BODY){if(this.getOption("clientId")&&this.getOption("clientSecret"))return Object.assign(Object.assign({},e),{client_id:this.getOption("clientId"),client_secret:this.getOption("clientSecret")});throw Error("For request body client authentication method, please provide both clientId & clientSecret.")}return e}handleResponseError(e){let t=[];return e instanceof s.UA?e.error.error_description?t.push(e.error.error_description):t=this.getOption("defaultErrors"):t.push(e instanceof h.ww?e.message:"Something went wrong."),(0,n.of)(new p.g(!1,e,this.getOption("redirect.failure"),t,[]))}buildRedirectUrl(){const e=Object.assign({response_type:this.getOption("authorize.responseType"),client_id:this.getOption("clientId"),redirect_uri:this.getOption("authorize.redirectUri"),scope:this.getOption("authorize.scope"),state:this.getOption("authorize.state")},this.getOption("authorize.params"));return`${this.getActionEndpoint("authorize")}?${this.urlEncodeParameters(this.cleanParams(e))}`}parseHashAsQueryParams(e){return e?e.split("&").reduce((e,t)=>{const r=t.split("=");return e[r[0]]=decodeURIComponent(r[1]),e},{}):{}}urlEncodeParameters(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}createRefreshedToken(e,t,r){const s=this.createToken(e,r);return!s.getRefreshToken()&&t.getRefreshToken()&&s.setRefreshToken(t.getRefreshToken()),s}register(e){throw new Error("`register` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}requestPassword(e){throw new Error("`requestPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}resetPassword(e={}){throw new Error("`resetPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}logout(){return(0,n.of)(new p.g(!0))}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(s.eN),d.LFG(g.gz),d.LFG(u.Q3))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})()},67846:function(e,t,r){r.d(t,{O:function(){return w}});var s=r(91841),n=r(25917),o=r(88002),i=r(5304),a=r(43190),u=r(42305),c=r(95607),h=r(93264),p=r(41854),l=r(47852);const d=new class extends p.Y{constructor(){super(...arguments),this.baseEndpoint="/api/auth/",this.login={alwaysFail:!1,endpoint:"login",method:"post",requireValidToken:!0,redirect:{success:"/",failure:null},defaultErrors:["Login/Email combination is not correct, please try again."],defaultMessages:["You have been successfully logged in."]},this.register={alwaysFail:!1,endpoint:"register",method:"post",requireValidToken:!0,redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully registered."]},this.requestPass={endpoint:"request-pass",method:"post",redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Reset password instructions have been sent to your email."]},this.resetPass={endpoint:"reset-pass",method:"put",redirect:{success:"/",failure:null},resetPasswordTokenKey:"reset_password_token",defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your password has been successfully changed."]},this.logout={alwaysFail:!1,endpoint:"logout",method:"delete",redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully logged out."]},this.refreshToken={endpoint:"refresh-token",method:"post",requireValidToken:!0,redirect:{success:null,failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your token has been successfully refreshed."]},this.token={class:h.xC,key:"data.token",getter:(e,t,r)=>(0,l.hB)(t.body,r.token.key)},this.errors={key:"data.errors",getter:(e,t,r)=>(0,l.hB)(t.error,r.errors.key,r[e].defaultErrors)},this.messages={key:"data.messages",getter:(e,t,r)=>(0,l.hB)(t.body,r.messages.key,r[e].defaultMessages)}}};var g=r(37716),f=r(10494);let w=(()=>{class e extends c.D{constructor(e,t){super(),this.http=e,this.route=t,this.defaultOptions=d}static setup(t){return[e,t]}authenticate(e){const t="login",r=this.getOption(`${t}.method`),s=this.getActionEndpoint(t),n=this.getOption(`${t}.requireValidToken`);return this.http.request(r,s,{body:e,observe:"response"}).pipe((0,o.U)(r=>{if(this.getOption(`${t}.alwaysFail`))throw this.createFailResponse(e);return r}),(0,o.U)(e=>new u.g(!0,e,this.getOption(`${t}.redirect.success`),[],this.getOption("messages.getter")(t,e,this.options),this.createToken(this.getOption("token.getter")(t,e,this.options),n))),(0,i.K)(e=>this.handleResponseError(e,t)))}register(e){const t="register",r=this.getOption(`${t}.method`),s=this.getActionEndpoint(t),n=this.getOption(`${t}.requireValidToken`);return this.http.request(r,s,{body:e,observe:"response"}).pipe((0,o.U)(r=>{if(this.getOption(`${t}.alwaysFail`))throw this.createFailResponse(e);return r}),(0,o.U)(e=>new u.g(!0,e,this.getOption(`${t}.redirect.success`),[],this.getOption("messages.getter")(t,e,this.options),this.createToken(this.getOption("token.getter")("login",e,this.options),n))),(0,i.K)(e=>this.handleResponseError(e,t)))}requestPassword(e){const t="requestPass",r=this.getOption(`${t}.method`),s=this.getActionEndpoint(t);return this.http.request(r,s,{body:e,observe:"response"}).pipe((0,o.U)(e=>{if(this.getOption(`${t}.alwaysFail`))throw this.createFailResponse();return e}),(0,o.U)(e=>new u.g(!0,e,this.getOption(`${t}.redirect.success`),[],this.getOption("messages.getter")(t,e,this.options))),(0,i.K)(e=>this.handleResponseError(e,t)))}resetPassword(e={}){const t="resetPass",r=this.getOption(`${t}.method`),s=this.getActionEndpoint(t),n=this.getOption(`${t}.resetPasswordTokenKey`);return e[n]=this.route.snapshot.queryParams[n],this.http.request(r,s,{body:e,observe:"response"}).pipe((0,o.U)(e=>{if(this.getOption(`${t}.alwaysFail`))throw this.createFailResponse();return e}),(0,o.U)(e=>new u.g(!0,e,this.getOption(`${t}.redirect.success`),[],this.getOption("messages.getter")(t,e,this.options))),(0,i.K)(e=>this.handleResponseError(e,t)))}logout(){const e="logout",t=this.getOption(`${e}.method`),r=this.getActionEndpoint(e);return(0,n.of)({}).pipe((0,a.w)(e=>r?this.http.request(t,r,{observe:"response"}):(0,n.of)(e)),(0,o.U)(t=>{if(this.getOption(`${e}.alwaysFail`))throw this.createFailResponse();return t}),(0,o.U)(t=>new u.g(!0,t,this.getOption(`${e}.redirect.success`),[],this.getOption("messages.getter")(e,t,this.options))),(0,i.K)(t=>this.handleResponseError(t,e)))}refreshToken(e){const t="refreshToken",r=this.getOption(`${t}.method`),s=this.getActionEndpoint(t),n=this.getOption(`${t}.requireValidToken`);return this.http.request(r,s,{body:e,observe:"response"}).pipe((0,o.U)(r=>{if(this.getOption(`${t}.alwaysFail`))throw this.createFailResponse(e);return r}),(0,o.U)(e=>new u.g(!0,e,this.getOption(`${t}.redirect.success`),[],this.getOption("messages.getter")(t,e,this.options),this.createToken(this.getOption("token.getter")(t,e,this.options),n))),(0,i.K)(e=>this.handleResponseError(e,t)))}handleResponseError(e,t){let r=[];return e instanceof s.UA?r=this.getOption("errors.getter")(t,e,this.options):r.push(e instanceof h.ww?e.message:"Something went wrong."),(0,n.of)(new u.g(!1,e,this.getOption(`${t}.redirect.failure`),r))}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(s.eN),g.LFG(f.gz))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac}),e})()},48722:function(e,t,r){r.d(t,{P:function(){return o}});var s=r(65131),n=r(37716);let o=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[s.P]]}),e})()}}]);